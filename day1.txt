
- hosts: web
  become: true
  pre_tasks:
    - name: check the background
      apt:
        update_cache: yes
        cache_valid_time: 3600
    - name: Gather OS information
      setup:
        gather_subset:
          - "os_family"
    - name: OS Family Status
      debug:
        msg: "The underlying OS Family is: {{ansible_os_family}}"
  tasks:
    - name: Install Apache2 software on remote machine
      apt:
        name:
          - apache2
        
        state: latest
    - name: start apache service
      service:
        name: apache2
        state: started
    
    - name: check installation status
      command: systemctl status apache2
      register: apache_status
    
    - name: print the status
      debug:
        msg: "{{apache_status.stdout}}"
